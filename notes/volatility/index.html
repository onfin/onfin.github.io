
<!DOCTYPE html>

<html lang="ru">
<head>
    <title>Волатильность как мера риска</title>
    <meta charset="utf-8" />
    <link rel="canonical" href="/notes/volatility" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/style.css" />
    <link href="/feed.atom.xml" type="application/atom+xml" rel="alternate" title="Житейские воззрения пана Семушельского Atom Feed" />
        <meta name="description" content="Заблуждения про волатильность и нюансы её расчёта" />
        <meta name="keywords" content="финансовая математика, волатильность, стандартное отклонение, риск" />

<meta property="og:locale" content="ru" />
    <meta property="og:description" content="Заблуждения про волатильность и нюансы её расчёта" />
    <meta property="og:type" content="article" />
        <meta property="og:article:published_time" content="2020-06-30" />
        <meta property="og:article:modified_time" content="2020-06-30" />
<meta property="og:title" content="Волатильность как мера риска" />
<meta property="og:url" content="https://onfin.github.io/notes/volatility" />
        <script>
            MathJax = {
                tex: {
                    inlineMath: [['$', '$'], ['\\(', '\\)']],
                    displayMath: [['$$', '$$'], ['\\[', '\\]']]
                },
                chtml: {
                    scale: 1,
                    matchFontHeight: true
                }
            };
        </script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>




</head>
<body>
    <header>
        <nav class="menu">
            <label class="menu-container" for="toggle-menu">
                <div class="menu-head">
                    <a href="/" class="menu-link menu-link-home">Житейские воззрения пана Семушельского</a>
                    <div class="social">
                        <a href="https://t.me/on_fin" class="menu-link"><i class="share">&#xea9b;</i></a>
                        <a href="/feed.atom.xml" class="menu-link"><i class="share">&#xea9f;</i></a>
                    </div>
                </div>
                <div class="checkmark">&equiv;</div>
            </label>
            <input type="checkbox" id="toggle-menu" />
            <ul class="menu">
                    <li class="menu-item"><a href="/blog" class="menu-link">Сиюминутное</a></li>
                    <li class="menu-item"><a href="/literacy" class="menu-link">Грамотность</a></li>
                    <li class="menu-item"><a href="/notes" class="menu-link">Заметки</a></li>
                    <li class="menu-item"><a href="/pages/sources" class="menu-link">Источники</a></li>
                    <li class="menu-item"><a href="/calculators" class="menu-link">Калькуляторы</a></li>
            </ul>
        </nav>
    </header>

    <main>


<article>
    <header>
        <h1>Волатильность как мера риска</h1>
        <div class="meta">
                <p class="description">Заблуждения про волатильность и нюансы её расчёта</p>
                <p> Обновлено: <time>2020-06-30</time> </p>

        </div>
    </header>

    <div class="content">
        <p>В науке о финансах и управлении портфелем в качестве меры риска используется волатильность портфеля (стандартное отклонение доходностей) как степень неопределённости результатов инвестиций. Такой подход не является единственно возможным и я уже обсуждал <a href="/notes/diversification_math2">возможные альтернативные определения риска</a> и их влияние на структуру оптимального по риск-доходности портфеля. Однако, разберёмся подробнее со стандартным определением, потому что даже относительно него имеется огромное количество заблуждений и нюансов использования.</p>
<p>Начнём с определений. Стандартное отклонение параметра $x$ это среднеквадратичное расстояние от всех его измерений $x_i$ до среднего по всем измерениям $\bar{x}$:</p>
<p>$$ s = \sqrt{\sum_{i=1}^N \frac{\left( x_i - \bar{x} \right)^2}{N-1}}, \bar{x} = \frac{1}{N}\sum_{i=1}^{N}x_i $$</p>
<p>А что брать за параметр $x$, когда мы оцениваем волатильность финансовых инструментов или портфелей? Первое, что обычно приходит на ум незнакомым с теоретическими финансами людям — динамика цены или размера вложенного капитала. Вместе с очевидной неадекватностью такого выбора: см. рисунок, где серым показаны отклонения, которые будут засчитаны в волатильность (это график индекса полной реальной доходности SnP500 с 1928г).</p>
<p><img src=/notes/volatility/price_vol.svg style="width: 100%; height: 50wv" /></p>
<p>Из всей критики <a href="/notes/mpt">современной портфельной теории (СПТ)</a> больше всего почему-то слышно критику вот такого подхода к измерению риска. Хотя СПТ так риск <strong>не</strong> измеряет.</p>
<p>Прежде чем обратиться к подходу СПТ, посмотрим, как мы можем разумно подойти к оценке ценовой волатильности (это не самая бесполезная вещь, если подойти к ней правильно).</p>
<p>Во-первых, у нас растущий график. В случае наличия явного тренда, значительный (если не основной, как в нашем примере) вклад в волатильность будет вносить сам тренд. Поэтому, для корректной оценки волатильности, тренд надо вычесть (т.е. считать отклонения от тренда, а не среднего значения цены за весь период наблюдений).</p>
<p>Во-вторых, тренд у нас — экспоненциальный. Если мы будем для оценки волатильности считать отклонения от линейного роста, ничего хорошего из этого не выйдет:
<img src=/notes/volatility/price_vol_lin.svg style="width: 100%; height: 50wv" /></p>
<p>Чтобы корректно вычесть тренд нужно построить его модель и найти её параметры. В случае экпоненциального роста тут всё просто, подгоняем методом наименьших квадратов параметры $x_0$ и $r$ модели $x = x_0 r^t$. Получаем следующую картину:
<img src=/notes/volatility/price_vol_exp.svg style="width: 100%; height: 50wv" /></p>
<p>Уже лучше, но...</p>
<p>В-третьих, индекс с течением времени растёт, растёт и размах колебаний в абсолютных величинах. Наш подход к волатильности все колебания до (визуально) 1970-х будет считать околонулевыми, что вопиюще некорректно: инвестора интересует <em>относительное</em> изменение стоимости его портфеля: в разах, а не в долларах. Для этого необходимо смотреть на колебания не самой стоимости портфеля, а её логарифма. Выглядеть это будет так:
<img src=/notes/volatility/price_vol_log.svg style="width: 100%; height: 50wv" /></p>
<p>Вот теперь всё правильно (в логарифмической шкале экспоненциальный тренд становится линейным, и теперь мы определяем параметры модели уже для линейного тренда $x = x_0 + r \cdot t$; определяем заново, а не просто логарифмируем полученный на предыдущем шаге экспоненциальный тренд — т.к. при его расчёте начальный период роста мы оставляли практически без внимания).</p>
<p>На следующем рисунке показаны рассчитанные таким образом волатильности на разных временны́х окнах (приведённые к процентам), пунктиром — средние за весь период наблюдений на соответствующем окне. То есть, <strong>чем дольше вы наблюдаете за портфелем, тем больше вы увидите его отклонение <em>в процентах</em> от ожидаемого при равномерном росте</strong>.</p>
<p><img src=/notes/volatility/price_vol_hist.svg style="width: 100%; height: 50wv" /></p>
<p>Известный аргумент, что волатильность учитывает отклонения в обе стороны от ожидания, а риском для инвестора являются отклонения только в негативную сторону, тут не работает. Потому что параметры модели тренда подбираются так, чтобы он проходил <em>между</em> всеми наблюдениями на кратчайшем расстоянии т.е. наиболее симметричным образом (посмотрите на предпоследний график). Поэтому волатильность в обе стороны получается приблизительно одинаковой и риск в 40% — это риск в 40% в минус.</p>
<p>Получив этот важный вывод, переходим к <em>волатильности доходности</em>.</p>
<p>Современная портфельная теория принимает за риск портфеля разброс (измеряемый как стандартное отклонение от среднего) возможных значений его <em>доходности</em> т.е. разброс <em>результатов</em> инвестирования за определённый период. Выглядит это так (здесь показано распределение годовых доходностей индекса SnP500):</p>
<p><img src=/notes/volatility/return_vol.svg style="width: 100%; height: 50wv" /></p>
<p>Вроде бы, достаточно адекватный индикатор. Но только если мы выкинем из головы идею, что стандартное отклонение от среднего покрывает 68,26% возможных значений, а три стандартных отклонения — 99,72%. Это справедливо для нормальных распределений, но категорически не соответствует распределениям рыночных доходностей, которые имеют длинные хвосты:</p>
<p><img src=/notes/volatility/return_vol_tails.svg style="width: 100%; height: 50wv" /></p>
<p>Ещё заметнее этот эффект, если посмотреть не на годовые, а на дневные доходности (<a href="https://stooq.com/q/d/?s=%5Espx">источник</a>).</p>
<p><img src=/notes/volatility/return_vol_d.svg style="width: 100%; height: 50wv" /></p>
<p>Игнорирование длинных хвостов и попытки вычислять вероятности получения экстремальных доходностей из матстатистики — одна из самых частных причин того, что «количественные» теории управления рисками инвестиций регулярно разоряют тех, кто ими пользуется (наиболее громким банкротством по этой причине является, пожалуй, <a href="https://ru.wikipedia.org/wiki/Long-Term_Capital_Management">LTCM</a>).</p>
<p>Длинные хвосты также приводят к тому, что на коротких интервалах среднее значение доходности оказывается очень сильно смещено в сторону «несбалансированного» хвоста и не даёт адекватного представления о характерной доходности на данном периоде. Поэтому среднеквадратичное отклонение нужно считать не от среднего значения, а от медианы, которая гораздо более устойчива.</p>
<p>Другой нюанс такого подхода к риску в портфельной теории — правильный выбор временного интервала, на котором берётся  доходность. Если мы хотим оценить <a href="/notes/mpt">премию за ребалансировку по Бернстайну</a>, то в качестве временного интервала нужно брать период между ребалансировками. Если же мы хотим оценить риск портфеля, то нужно брать горизонт инвестирования целиком. Любой более короткий интервал будет бессмысленным: риск как волатильность доходности не учитывает рисков, возникающих на <em>последовательности</em> итервалов.</p>
<p>Здесь нас подстерегает ещё один очень важный для понимания момент. Риск как волатильность полученной итоговой доходности с ростом горизонта инвестирования снижается:</p>
<p><img src=/notes/volatility/return_vol_hist.svg style="width: 100%; height: 50wv" /></p>
<p>Казалось бы, это противоречит предыдущему выводу о том, что чем больше срок наблюдения за портфелем, тем более сильные отклонения от ожидаемого его размера мы увидим. Но противоречния здесь нет: чем длиннее срок инвестирования, тем сильнее небольшие отклонения доходности влияют на результат. Отклонение итоговой доходности в 2,5%г на горизонте в 30 лет даст отклонение в размере портфеля на 210%, что гораздо выше, чем эффект отклонения в итоговой доходности на 40%г на интервале в 3 месяца (всего 10% от портфеля).</p>
<p>Нельзя просто так взять и посчитать волатильность, или сослаться на какую-то из источника. Нужно сперва понять зачем это нужно, какую волатильность и на каком интервале правильно использовать.</p>
    </div>
    <aside>
        <div style="display: flex; flex-direction: column; text-align: right;">
        <div class="share-buttons">
            <a href="https://vk.com/share.php?url=https://onfin.github.io/notes/volatility&title=Волатильность как мера риска&description=Заблуждения про волатильность и нюансы её расчёта" target="_blank"><i class="share">&#xea9d;</i></a>
            <a href="https://t.me/share/url?url=https://onfin.github.io/notes/volatility" target="_blank"><i class="share">&#xea9b;</i></a>
            <a href="https://twitter.com/intent/tweet?text=https://onfin.github.io/notes/volatility" target="_blank"><i class="share">&#xea9c;</i></a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://onfin.github.io/notes/volatility" target="_blank"><i class="share">&#xea93;</i></a>

        </div>
        <a class="donate-button" href="/donate">Отблагодарить</a>
    </div>
    </aside>
</article>

    </main>

    <footer>
<div class="prevupnext"><a class="prev" href="/notes/mpt"> &lt;&lt; (Не)Математика диверсификации-3: современная теория портфеля </a><a class="up" href="/notes"> &uarr; Заметки о финансах &uarr; </a><a class="next" href="/notes/inflation"> Инфляция &gt;&gt; </a></div>

        <div class="disclaimer">
            <p>Здесь я выкладываю лишь собственные размышления/исследования/расчёты, иногда собственное же изложение чужих мнений или результатов исследований. Размещённая информация может содержать ошибки, быть неактуальной на момент прочтения, допускать множество интерпретаций и проч. Я не занимаюсь образовательной деятельностью и не даю инвестиционных рекомендаций ни на этом сайте, ни в частном порядке.</p>

            <p>Может быть, вам показалось, но способов получить гарантированную доходность за счёт каких бы то ни было финансовых инструментов, портфелей или торговых стратегий НЕ СУЩЕСТВУЕТ. Хуже того, способов гарантированно сохранить свой капитал тоже НЕ СУЩЕСТВУЕТ.</p>

            <p>Материалы сайта могут быть использованы на условиях лицензии <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA</a>.
            <br> &copy; <a href="https://t.me/blksv" rel="author">Андрей Болкисев</a>, 2020.
            </p>
        </div>
    </footer>
</body>
</html>